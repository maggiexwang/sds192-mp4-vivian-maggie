---
title: "4-Hour Movie? <br> Frankly, My Dear, I Don't Give A Damn."
author: "Vivian Wang, Maggie Wang"
date: "December 3, 2017"
output:
  html_document:
    code_folding: hide
    theme: simplex
    fig_width: 10
    fig_caption: true
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mdsr)
library(RMySQL)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(grid)
library(gridExtra)
library(humaniformat)
db <- dbConnect_scidb(dbname = "imdb")
```

It is December 15, 1939 and Loew’s Grand Theatre is shining as center stage for the premiere of American classic, [*Gone With The Wind*](https://en.wikipedia.org/wiki/Gone_with_the_Wind_(film)). Over the next few months, Scarlett and her beloved Rhett will go on to sweep audiences off their feet, shatter attendance records nationwide, and garner reverent reviews from magazines and newspapers alike. Amongst the glowing praise, however, are a few grumbles. Some reviewers felt the film was unnecessarily dragged out with repetitious scenes and mundane dialogue upping the minute count. Their claims were not unfounded: *Gone With The Wind clocked* in with a staggering 4-hour runtime which made it the longest American film of its day.  

Flash forward to the present, *Gone With The Wind* continues to hold a place amongst the [top 20 longest](http://www.amc.com/talk/2007/11/the-longest-ame-1) American movies ever made. Simultaneously, extended film lengths are again evoking similar ire amongst [millennial moviegoers](http://www.randalolson.com/2014/01/25/movies-arent-actually-much-longer-than-they-used-to-be/) who complain that movies are becoming longer than they used to be. But, have they really gotten longer since the days of black-and-white? Complaining millennials aside, do the rest of us really hate the extra film time?

As they battle for profits with entertainment competitors such as Netflix and YouTube, production studios and other movie industry players have high stakes in understanding audience preferences. Luckily, with the advent of the Internet, we now have the means to address these questions with the runtimes and ratings within the [International Movie Database (IMDb)](http://www.imdb.com/). The data reveals not only film length patterns that reflect the history of entertainment technology, but also that we take a page from Rhett when it comes to enjoying long movies: frankly, we don’t give a damn.

```{r}
# Pull information all at once from server via sql query
# Limited to films more than 60mins long, produced in the US, and not adult

ratelength_sql <- "
SELECT t.id, t.title, 
	t.production_year AS Year, 
  mii.info AS Rating,
  mi.info AS Length, 
  mii2.info AS Votes,
  n.name AS Director
FROM title t
JOIN movie_info_idx mii ON mii.movie_id = t.id
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info_idx mii2 ON mii2.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
JOIN movie_info mi3 ON mi3.movie_id = t.id
JOIN cast_info ci ON ci.movie_id = t.id
JOIN name n ON n.id = ci.person_id
WHERE t.kind_id = 1
AND mii.info_type_id = 101
AND mi.info_type_id = 1
AND mi.info > 59
AND mii2.info_type_id = 100
AND mii2.info > 1000
AND mi2.info_type_id = 3
AND mi2.info NOT LIKE '%Adult%'
AND mi3.info_type_id = 8
AND mi3.info LIKE '%USA%'
AND ci.role_id = 8
GROUP BY t.id;
"

ratelength <- db %>% 
  dbGetQuery(ratelength_sql) %>% 
  mutate(Length = as.integer(Length)) %>% 
  mutate(Rating = as.numeric (Rating)) %>% 
  mutate(Votes = as.integer(Votes))
```

```{r warning=FALSE, fig.align="center"}
# Find average film length over the years
avg_length <- ratelength %>% 
  group_by(Year) %>% 
  summarize(Length = mean(Length))

# Plot average length against year of film release
avg_length %>% ggplot(aes(x = Year, y = Length)) + 
  geom_point(shape = 18, color = "royalblue4") + 
  geom_line(color = "royalblue4") + 
  theme_wsj() + 
  theme(axis.title = element_text(size = 15)) + 
  scale_x_continuous(limits = c(1920, 2017),
                     breaks = c(1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010)) + 
  scale_y_continuous(name = "Movie Length", limits = c(60,150), 
                     breaks = c(60, 90, 120, 150),
                     labels = c("1h", "1.5h", "2h", "2.5h"))
```

Graph 1. Average movie length over time.  

The first task of the day is demystifying the accusations around increasing movie length here in the U.S. In Graphic 1 above, the length of all the movies released in each year are averaged out and displayed against a time scale running from the old glamour of the 1920s to modern Hollywood productions. Besides the sharp uptick around 1925 when the Golden Age of Hollywood popularized long feature films, average film length seems to have generally remained between 1.5 and 2 hours throughout the years. In other words, movie lengths haven’t been significantly extended over the decades.   

So do millennials lose this match point? Not quite. Though Graphic 1 shows average length predominantly staying within the 1.5 to 2 hour threshold, there are clearly slight ups-and-downs from decade to decade. When the millennial generation was arriving on scene (born 1985-2000) and filling theater seats, runtime averages were indeed on the rise. From their perspective, they aren’t wrong in arguing that movies have gotten longer. Conversely, to the Generation Xers (born 1965-1985) insisting that millennials whine too much, Graphic 1 provides a reminder that the victory of and subsequent adherence to 2-hour VHS tapes in the videotape format war of the 70s slashed an average of 10 minutes off your childhood movies. There’s no clear winner here; we’re all justified from our own time perspectives.   

Apart from the ongoing Generation X v. Millennials showdown, the period from 1930 to 1960 also exhibits an interesting upward trend with a peak around 1960 at 2 hours. The introduction of television in the 30s forced movie producers to compete by releasing more epic films that extended runtimes by an average of around 30 minutes through the 60s. Nowadays, television’s reincarnation into streaming such as Netflix doesn’t appear to threaten movie studios as much as it used to. From 2000 onwards, Graphic 1 shows a stagnation of average runtimes at around 1.7 hours.  


Then why are we, hard-to-please audiences, whining about long movies? Recall the last time you sat through a 3 hour movie - did you walk out of the theater complaining about how bad you had to pee, or about how tedious the film was? Data shows that your last hour of suffering is most likely worth it - longer films are actually rated higher.  

```{r fig.align="center"}
# Bin film length, find count and average rating
avg_rating_length <- ratelength %>% 
  mutate(Length = cut(ratelength$Length, 
                      breaks = c(-Inf, 90, 120, 150, 180, 210, Inf), 
                      labels = c("1h", "1.5h", "2h", "2.5h", "3h", "3.5h+"),
                      include.lowest = TRUE)) %>% 
  group_by(Length) %>% 
  summarize(num = n(), Rating = mean(Rating))
  
# Plot rating against length
# Size of diamond indicate number of films in the bin
avg_rating_length %>%
  ggplot(aes(x = Length, y = Rating)) + 
  geom_point(aes(size = num), shape = 18, 
             color = "royalblue4") + 
  geom_label(aes(label = num), nudge_y = .5) + 
  theme_wsj() + 
  scale_size(range = c(1,30)) + 
  theme(legend.position = "none") + 
  theme(axis.title = element_text(size = 15)) +
  scale_x_discrete(name = "Movie Length") +
  scale_y_continuous(name = "Average Rating", 
                     limits = c(5.5, 8.35))
```

Graphic 2. Long movies and their ratings.  

Graphic 2 above shows how the average ratings of movies change as their lengths increase, with the size of the diamonds indicating how many films are of that binned length. For example, there are 1421 movies that are longer than 2 hours but shorter than 2 hours 30 minutes, and their average rating is around 7.0. Most movies run for 90-120 minutes, and have a mediocre average rating around 6.4. So, some takeaway for aspiring young filmmakers: consider the long-run, literally.  

Now, there are many possible explanations to this phenomenon. From a production point of view, it could be that if a director can sell a longer-than-average movie to his producers and studios, the movie is probably fairly good. It could be that stories of certain kind require more time to tell: those that include more details, fictional worlds, better-crafted characters, or other elements that make stories more convincing, and thus make the films more enjoyable. 

```{r warning=FALSE}
# Big directors and film length
bignames <- ratelength %>% 
  select(-id, -Rating) %>% 
  filter(Director %in% 
           c('Scorsese, Martin','Tarantino, Quentin')) %>% 
  filter(Votes > 5000) %>% 
  mutate(Director = format_reverse(Director))

avg_length %>% ggplot(aes(x = Year, y = Length)) +
  geom_area(stat = "identity", alpha = 0.2) + 
  theme_wsj() + 
  theme(axis.title = element_text(size = 15), 
        legend.title = element_blank()) + 
  scale_x_continuous(name = "Year", limits = c(1970, 2017)) +  
  scale_y_continuous(name = "Movie Length", 
                     breaks = c(-Inf, 60, 120, 180, Inf), 
                     labels = c('1h-', '1h', '2h', '3h', '3h+')) +
  coord_cartesian(ylim = c(60, 180)) + 
  geom_point(data = bignames, aes(color = bignames$Director), shape = 18, size = 2.5) + 
  geom_line(data = bignames, aes(color = bignames$Director), size = 1.2) + 
  scale_color_manual(values = c("RoyalBlue4", "darkred"))
```


At these lengths, movies are endurance tests for how long we can remain seated in close proximity to complete strangers while having 8 megapixels of light flashing in our faces. A person who simply cannot stand longer movies might therefore argue: look, only the people who are already invested enough in the specific topic or characters of that 3 hour long film are going to sit through it, of course they are going to rate it higher. Yet based on how many times the 10 highest-rated long films were rated on IMDb (Votes), long films are not necessarily niche - you must recognize some of these big names in the table below:  

```{r fig.align="center"}
# Find information about films longer than 3h
genre_long <- ratelength %>% 
  filter(Length >= 180) 

# Show information of 10 highest-rated long films
genre_long %>% 
  select(-id) %>% 
  rename('Film' = 'title') %>% 
  arrange(desc(Rating), desc(Votes)) %>% 
  head(10) %>% 
  grid.table()
```

Graph 4. Top 10 highest-rated films longer than 3 hours.  

So, long story short: even if that next *Star Wars* franchise is 4 hours long, we’ll still be happily glued to our seats and devotedly chanting “May the Force Be With You” all the way through.